# -*- coding: utf-8 -*-
"""
Created on Fri Sep  2 23:03:15 2022

@author: User
"""
# Detecting Access Point Clients

from scapy.all import *

probe_list = []

ap_name = input("Enter the name of the access point: ")

def Probe_info(pkt):
    if pkt.haslayer(Dot11ProbeReq):
       client_name = pkt.info
       if client_name == ap_name:
           print("New Probe Request--", client_name)
           print("MAC is --", pkt.addr2)
           probe_list.append(pkt.addr2)
           
sniff(iface="mon0", prn = Probe_info)
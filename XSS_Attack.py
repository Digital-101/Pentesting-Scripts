# -*- coding: utf-8 -*-
"""
Created on Fri Sep  2 23:33:07 2022

@author: User
"""

import mechanize

url = input("Enter the full URL: ")
attack_no = 1

with open('vectors_XSS.txt') as x:
    browser = mechanize.Browser()
    for line in x:
        browser.open(url)
        browser.select_form(nr=0)
        browser["id"] = line
        res = browser.submit()
    content = res.read()
    if content.find(line) > 0:
        print("Possible XSS")
    # write to output file
    output = open('response/'+str(attack_no)+'.txt','w')
    output.write(content)
    output.close()
    print(attack_no)
    attack_no += 1
    


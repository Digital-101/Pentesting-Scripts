# -*- coding: utf-8 -*-
"""
Created on Fri Sep  2 22:52:24 2022

@author: User
"""
# Finding Wireless Service Set Identifier (SSID)
# mon0 <- captures wireless packets
# In KALI run -> airmon-ng start wlan1

import socket

# 0x0003 -> all packets
s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket. htons(0x0003))
s.bind("mon0", 0x0003)

ap_list = []
while True:
    packet = s.recvfrom(2048)
    # if 8 bits then its beacon frame :)
    if packet[26] == "\x80":
        if packet[36:42] not in ap_list and ord(packet[63]) > 0:
            ap_list.append(packet[36:42])
            
print("SSID: ",(packet[64:64+ord(packet[63])], packet[36:42].encode('hex')))